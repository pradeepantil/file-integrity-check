- name: Playbook to check file integrity via checksum
  hosts: localhost
  vars_files:
    - files_list.yml
  tasks:
  - name: check file checksum
    stat:
      path: "{{ item.name }}"
    with_items: "{{ files }}"
    register: test

  - name: debug file when checksum matched
    debug:
      msg: "Checksum matched"
    when: '"{{ item.item.checksum }}" == "{{ item.stat.checksum}}"'
    loop: "{{ test.results }}"
  
  - name: debug file when checksum matched
    debug:
      msg: "Checksum do not match"
    when: '"{{ item.item.checksum }}" != "{{ item.stat.checksum}}"'
    loop: "{{ test.results }}"


